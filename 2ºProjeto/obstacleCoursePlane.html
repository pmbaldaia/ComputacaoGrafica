<!DOCTYPE html>
<html>

<head>
    <meta charset="UTF-8">
    <title>THE SNOWBOARDER</title>
    <style>
        body {
            /* set margin to 0 and overflow to hidden, to use the complete page */
            margin: 0;
            overflow: hidden;
        }
    </style>
</head>

<body>
    <!-- HTML body will hold the Output -->
    <script type="module">
        import * as THREE from './libs/three.module.js';

        let camera, scene, renderer;
        let pivotMiddleBottom,pivotTopMiddle, snowmanBottom;

        let snowboard;
        let breakSnowman;
        
        // once everything is loaded, we run our Three.js stuff
        window.onload = function init() {

            // set up the scene, the camera and the renderer
            createScene();
            
            // add the objects
            createLand();
            createSnowman();
            createSnowboarder();

            // add the lights
            createLights();
            /*****************************
             * ANIMATE 
             * ***************************/
            
            // set the animation function
            renderer.setAnimationLoop(render);
        }

        function createScene(){
            
            // create an empty scene, that will hold all our elements such as objects, cameras and lights
            scene = new THREE.Scene();
            
            // create a camera, which defines where we're looking at
            const aspect = window.innerWidth / window.innerHeight;
            camera = new THREE.PerspectiveCamera(60, aspect, 1, 1500);
            camera.position.x = 1400;
            camera.position.y = 400;
            camera.position.z = 0;
            camera.lookAt(scene.position); //point the camera to the center of the scene

            // create a render and set the size
            renderer = new THREE.WebGLRenderer({ antialias: false }); // aliasing (jagged edges when rendering)
            renderer.setSize(window.innerWidth, window.innerHeight);

            // configure renderer clear color
            renderer.setClearColor("#BBD9ED");

             // add the output of the renderer to an HTML element (this case, the body)
             document.body.appendChild(renderer.domElement);

             // listen to the screen: if the user resizes it we have to update the camera and the renderer size
            window.addEventListener('resize', handleWindowResize, false);
        }

        function handleWindowResize() {
            // update height and width of the renderer and the camera
            const HEIGHT = window.innerHeight;
            const WIDTH = window.innerWidth;
            renderer.setSize(WIDTH, HEIGHT);
            camera.aspect = WIDTH / HEIGHT;
            camera.updateProjectionMatrix();
        }

        function createSnowman(){

            /*base Snowman*/
            let bottomBall = new THREE.SphereGeometry(80, 12, 8);
            let snow = new THREE.MeshLambertMaterial({color: 0xfffafa, wireframe: false });
            snowmanBottom = new THREE.Mesh(bottomBall, snow);
            snowmanBottom.position.y = 40
            scene.add(snowmanBottom);

            /*middle snowman pivot*/
            pivotMiddleBottom = new THREE.Object3D();
            snowmanBottom.add(pivotMiddleBottom);
            pivotMiddleBottom.position.y = 100

            /*middle Ball*/
            let middleBall = new THREE.SphereGeometry(60, 12, 8)
            let snowmanMiddle = new THREE.Mesh(middleBall, snow);
            pivotMiddleBottom.add(snowmanMiddle);

            /*top snowman pivot*/
            pivotTopMiddle = new THREE.Object3D();
            snowmanMiddle.add(pivotTopMiddle);
            pivotTopMiddle.position.y = 80

            /*top Ball*/
            let topBall = new THREE.SphereGeometry(40, 12, 8)
            let snowmanTop = new THREE.Mesh(topBall, snow);
            pivotTopMiddle.add(snowmanTop);
        }

        function createSnowboarder(){

            console.log("done");
            /*snowboard*/
            let snowboardGeometry = new THREE.PlaneGeometry(40,200, 32,32);
            let blackMaterial = new THREE.MeshLambertMaterial({color: 0x2A2C2F, side: THREE.DoubleSide});
            snowboard = new THREE.Mesh(snowboardGeometry, blackMaterial);
            snowboard.position.x = 750
            snowboard.position.z = 0
            snowboard.rotation.z = - Math.PI / 2;
            snowboard.rotation.x = - Math.PI / 2;

            scene.add(snowboard)

            /*frontBendBoard*/
            let frontBackBendBoardGeometry = new THREE.CylinderGeometry( 40, 40, 40, 8, 1,0,0,0.8 );
            let frontBendBoard = new THREE.Mesh( frontBackBendBoardGeometry, blackMaterial );
            frontBendBoard.position.y = -100;
            frontBendBoard.position.z = 40;
            frontBendBoard.rotation.z = Math.PI / 2;
            frontBendBoard.rotation.x = Math.PI;            
            snowboard.add( frontBendBoard );

            /*frontEndBoard*/
            let frontBackEndBoardGeometry = new THREE.CircleGeometry( 20,32,0,3);
            let frontEndBoard = new THREE.Mesh( frontBackEndBoardGeometry, blackMaterial );
            frontEndBoard.rotation.z = -Math.PI/2;
            frontEndBoard.rotation.y = Math.PI/4;
            frontEndBoard.position.x = 25
            frontEndBoard.position.z = 32
            frontBendBoard.add( frontEndBoard );

            /*BackBendBoard*/
            let backBendBoard = new THREE.Mesh( frontBackBendBoardGeometry, blackMaterial );
            backBendBoard.position.y = 100;
            backBendBoard.position.z = 40;
            backBendBoard.rotation.z = -Math.PI / 2;
            backBendBoard.rotation.x = Math.PI;            
            snowboard.add( backBendBoard );

            /*backEndBoard*/
            let backEndBoard = new THREE.Mesh( frontBackEndBoardGeometry, blackMaterial );
            backEndBoard.rotation.z = -Math.PI/2;
            backEndBoard.rotation.y = Math.PI/4;
            backEndBoard.position.x = 25
            backEndBoard.position.z = 32
            backBendBoard.add( backEndBoard );



            }
        
        function createLights(){

            let light = new THREE.AmbientLight(0xffffff, 0.5);
            scene.add(light);

            let light2 = new THREE.PointLight(0xffffff, 1);
            light2.position.set(1500, 1100, 0);
            scene.add(light2);
        }

        function createLand(){
            // Create a plane 
            let planeGeometry = new THREE.PlaneBufferGeometry(10000, 10000, 32, 32);
            let planeMaterial = new THREE.MeshLambertMaterial({ color: 0xFFFAFA, side: THREE.DoubleSide });
            let plane = new THREE.Mesh(planeGeometry, planeMaterial);
            plane.name = "plane"
            plane.rotation.x = - Math.PI / 2;
            plane.position.y = -1;
            scene.add(plane);

        }

        function render() {

            /*//moving bottomBall
             if (snowmanBottom.position.x < 1350){
                snowmanBottom.position.x += 10
             } else if (snowmanBottom.position.x >= 10) {
                snowmanBottom.position.x = -600
                snowmanBottom.position.y = -220
                 if (snowmanBottom.position.z == 0){
                    snowmanBottom.position.z = Math.random() > 0.5 ? 300 : -300
                 } else if (snowmanBottom.position.z == 300) {
                    snowmanBottom.position.z = Math.random() > 0.5 ? 0 : -300
                 } else if (snowmanBottom.position.z == -300) {
                    snowmanBottom.position.z = Math.random() > 0.5 ? 0 : 300
                 }
             }

             if(snowmanBottom.position.x > 750){
                snowmanBottom.position.y -= 5    
             } else if (snowmanBottom.position.x < 850 && snowmanBottom.position.y < 0){
                snowmanBottom.position.y += 5
            }*/ 
            
            /*//contact with snowman
            if(breakSnowman == true){

                if(snowmanBottom.rotation.x < Math.PI/2){
                    snowmanBottom.rotation.x +=0.04
                    snowmanBottom.rotation.z -=0.01
                }   
                if(snowmanBottom.rotation.x > Math.PI/4 && pivotMiddleBottom.position.y < 110){
                    pivotMiddleBottom.position.y += 1
                    pivotMiddleBottom.rotation.x += 0.01
                }
                if(snowmanBottom.rotation.x > Math.PI/3 && pivotTopMiddle.position.y < 140){
                    pivotTopMiddle.position.y += 1
                }

            }
            */

            // render the scene into viewport using the camera
            renderer.render(scene, camera);
        }


    </script>
</body>

</html>